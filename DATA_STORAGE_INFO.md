# 📊 项目数据存储说明

## 数据存储位置

### 当前环境
你的数据存储在 **PostgreSQL 云端数据库**中，具体信息：

- **数据库类型**: PostgreSQL
- **托管方式**: 通过集成服务提供
- **访问方式**: 通过 Drizzle ORM + SDK
- **持久性**: ✅ 持久化存储，不会丢失

---

## 🎯 能否长期使用？

### ✅ 可以！但需要注意以下几点：

#### 1. 在当前开发环境中
- ✅ 数据会一直保存
- ✅ 可以正常添加、修改、删除交易记录
- ✅ 数据不会因为重启而丢失
- ⚠️ 这是开发环境，不是生产环境

#### 2. 部署到自己的服务器
- ✅ 完全可控，可以长期使用
- ✅ 数据在你自己的数据库中
- ✅ 推荐使用 Vercel、Railway、Supabase 等

#### 3. 使用免费的云服务
- ✅ Vercel + Supabase（完全免费，足够个人使用）
- ✅ Railway（有免费额度）
- ✅ Render（有免费额度）

---

## 📍 数据存储架构

```
┌─────────────────────────────────────────┐
│  你的应用 (Next.js)                      │
│  - localhost:5000                       │
└────────────┬────────────────────────────┘
             │
             │ HTTP API
             ↓
┌─────────────────────────────────────────┐
│  PostgreSQL 云端数据库                   │
│  - 数据持久化存储                        │
│  - 通过集成服务提供                      │
│  - 支持读写操作                          │
└─────────────────────────────────────────┘
```

---

## 💾 数据持久性说明

### ✅ 数据不会丢失的情况：
- 服务器重启
- 代码更新
- 浏览器刷新
- 应用关闭后重新打开

### ⚠️ 可能丢失数据的情况：
1. **数据库服务到期或被删除**
   - 如果使用的是有免费期限的云服务
   - 建议：导出数据备份

2. **项目被删除**
   - 如果整个开发环境被清理
   - 建议：定期备份数据

3. **手动删除**
   - 调用 DELETE API
   - 清空数据库表

---

## 🔧 如何保证数据安全

### 方案 1: 定期备份数据

```bash
# 导出所有交易记录
curl http://localhost:5000/api/trades > trades_backup.json

# 或者使用脚本定期备份
```

### 方案 2: 部署到生产环境

```bash
# 部署到 Vercel（推荐）
vercel --prod

# 使用 Supabase 作为数据库
# 完全免费，适合个人使用
```

### 方案 3: 导出数据到本地

创建一个导出功能，将数据下载到本地：
- 导出为 JSON 文件
- 导出为 Excel 文件
- 导出为 CSV 文件

---

## 🌟 推荐的使用方式

### 对于个人长期使用：

#### 最佳方案：Vercel + Supabase

1. **Supabase**（免费数据库）
   - 注册：https://supabase.com/
   - 创建项目，获取数据库连接字符串
   - 完全免费，500MB 存储空间

2. **Vercel**（免费部署）
   - 注册：https://vercel.com/
   - 部署应用
   - 完全免费，足够个人使用

3. **配置环境变量**
   ```bash
   PGDATABASE_URL=postgresql://xxx@xxx.supabase.co/xxx
   ```

#### 成本：
- ✅ Supabase: 完全免费（500MB）
- ✅ Vercel: 免费版足够使用
- ✅ 总计：**$0 / 月**

---

## 📊 当前数据库状态

### 实时查询结果：
- **数据库类型**: PostgreSQL
- **当前记录数**: 0 条
- **表结构**: trades
- **字段数**: 13 个字段

### 数据字段：
1. id - 主键
2. symbol - 交易品种
3. direction - 交易方向
4. entryPrice - 开仓价格
5. exitPrice - 平仓价格
6. quantity - 数量
7. strategySummary - 策略总结
8. profitLoss - 盈亏
9. exitReason - 平仓原因
10. entryTime - 开仓时间
11. exitTime - 平仓时间
12. notes - 备注
13. isClosed - 是否平仓

---

## 🔍 如何验证数据持久性？

### 测试方法：
1. 添加一条交易记录
2. 刷新浏览器页面
3. 检查数据是否还在
4. 重启开发服务器
5. 再次检查数据

### 验证结果：
- ✅ 数据仍然存在 → 数据持久化正常
- ❌ 数据丢失 → 需要检查数据库连接

---

## 🚀 部署到自己的服务器

如果你想要完全掌控数据，可以：

### 步骤：
1. 选择云服务（Vercel、Railway 等）
2. 创建自己的 PostgreSQL 数据库
3. 配置环境变量 `PGDATABASE_URL`
4. 部署应用
5. 数据存储在你自己的数据库中

### 优点：
- ✅ 完全可控
- ✅ 数据安全
- ✅ 长期稳定
- ✅ 可以随时导出/备份

---

## 💡 总结

### 关于数据存储：
- ✅ 数据存储在云端 PostgreSQL 数据库
- ✅ 数据是持久化的，不会丢失
- ✅ 可以长期使用

### 建议：
1. **短期使用**: 当前环境即可，数据会一直保存
2. **长期使用**: 建议部署到 Vercel + Supabase
3. **数据安全**: 定期导出备份
4. **完全掌控**: 使用自己的服务器和数据库

### 当前环境特点：
- 📍 数据在云端数据库（非扣子服务器）
- 💾 持久化存储
- 🔄 支持读写操作
- 🛡️ 数据不会轻易丢失

---

## ❓ 常见问题

**Q: 数据会丢失吗？**
A: 在当前环境中，数据会一直保存。除非数据库服务被删除。

**Q: 我可以一直用这个吗？**
A: 可以！但建议部署到生产环境以获得更好的稳定性和性能。

**Q: 数据容量有限制吗？**
A: PostgreSQL 云端数据库通常有存储限制，但对于个人使用来说足够。

**Q: 可以导出数据吗？**
A: 可以！可以通过 API 导出为 JSON 格式。

**Q: 如果环境被清理怎么办？**
A: 建议定期备份数据，或者部署到自己的服务器。
